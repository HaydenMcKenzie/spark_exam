Setup.scala
    SET logger error
    CREATE SparkSession

    READ in files
        CREATE customerData
            from customer_data.csv
        CREATE accountData
            from account_data.csv
        READ addressData
            from address_data.csv


QuestionOne.scala
    FUNCTION questionOne
        JOIN accountData to customerData by "customerId"

        GROUPBY "customerId", "forename", "surname"
            CREATE Seq of all accountsId with the same "customerId", "forename", "surname".
                ALIAS column "accounts"
            COUNT elements in Seq of "accountId".
                ALIAS column "numberAccounts"
            ADD all numbers from "balance" and round to 2 decimal places.
                ALIAS column "totalBalance"
            AVERAGE all numbers from "balance" and round to 2 decimal places.
                ALIAS column "averageBalance"
        RETURN as Dataset[CustomerAccountOutput]

    FUNCTION answer
        CALL questionOne as answer: Dataset[CustomerAccountOutput]
        SHOW answer
        WRITE TO FILE
            Save as a Parquet file
        RETURN answer

    FUNCTION main
    CALL answer with "output" input


QuestionTwo.scala
    FUNCTION questionTwo
        JOIN parquetData and parsedData via "customerId" column
        CREATE a new Dataset
            SELECT "customerId"
            SELECT "forename"
            SELECT "surname"
            SELECT "accounts"
            SELECT "addressId","customerId","address","number","road","city" and "country"
                Put into an Array
                ALIAS "address"

    FUNCTION answer
        TRY
            READ Parquet file
                from Question 1
            PARSE "address" column from addressData
                SEPARATE into "number","street","city","country"

            CALL questionTwo as answer: Dataset[CustomerDocument]

            SHOW answer
            RETURN answer
        CATCH
            Exception error

    FUNCTION main
        CALL answer with "output", addressData and "address" inputs